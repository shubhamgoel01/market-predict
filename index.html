<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Market Data</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        table { width: 60%; margin: auto; border-collapse: collapse; }
        th, td { padding: 10px; border: 1px solid #ddd; }
        th { background: #333; color: white; }
        .buy { color: green; font-weight: bold; }
        .sell { color: red; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Live Market Data</h1>
    <table>
        <tr>
            <th>Time</th>
            <th>Open</th>
            <th>High</th>
            <th>Low</th>
            <th>Close</th>
            <th>Volume</th>
            <th>RSI</th>
            <th>MACD</th>
            <th>Signal Line</th>
            <th>Trade Signal</th>
        </tr>
        <tr id="data-row">
            <td colspan="10">Waiting for data...</td>
        </tr>
    </table>

    <script>
        const socket = new WebSocket("ws://localhost:8765");

        socket.onopen = () => console.log("Connected to WebSocket server");

        socket.onmessage = (event) => {
            const data = JSON.parse(event.data);
            const row = document.getElementById("data-row");

            row.innerHTML = `
                <td>${new Date(data.time).toLocaleTimeString()}</td>
                <td>${data.open}</td>
                <td>${data.high}</td>
                <td>${data.low}</td>
                <td>${data.close}</td>
                <td>${data.volume}</td>
                <td>${data.rsi}</td>
                <td>${data.macd}</td>
                <td>${data.signal_line}</td>
                <td class="${data.trade_signal.toLowerCase()}">${data.trade_signal}</td>
            `;
        };

        socket.onerror = (error) => console.error("WebSocket Error:", error);
        socket.onclose = () => console.log("WebSocket connection closed");
    </script>
</body>
</html>
